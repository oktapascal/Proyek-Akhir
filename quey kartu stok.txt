SELECT transaksi.tanggal_transaksi, transaksi.kode_transaksi, detail_pembelian.jumlah as jumlah_beli, detail_pembelian.harga_beli, detail_pembelian.subtotal as subtotal_beli, detail_penjualan.jumlah as jumlah_jual, detail_penjualan.harga_jual, detail_penjualan.subtotal as subtotal_jual FROM transaksi LEFT JOIN detail_pembelian ON transaksi.kode_transaksi=detail_pembelian.kode_transaksi LEFT JOIN detail_penjualan ON transaksi.kode_transaksi=detail_penjualan.kode_transaksi WHERE transaksi.kode_transaksi NOT LIKE 'STR%' AND MONTH(transaksi.tanggal_transaksi) = '04' AND YEAR(transaksi.tanggal_transaksi) = '2019' AND detail_pembelian.kode_pisang = 'PSG-00001' OR detail_penjualan.kode_pisang = 'PSG-00001' ORDER BY transaksi.tanggal_transaksi ASC, transaksi.kode_transaksi ASC